<Page x:Class="TinyClaw.App.Views.DashboardPage"
               xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
               xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
               Title="Dashboard">
    <ScrollViewer>
        <StackPanel Margin="24">
            <!-- Title -->
            <TextBlock Text="Dashboard" Style="{StaticResource TitleTextBlockStyle}" Margin="0,0,0,16" />

            <!-- Status Cards Row -->
            <UniformGrid Columns="4" Margin="0,0,0,16">
                <ui:CardControl Margin="4">
                    <StackPanel>
                        <TextBlock Text="Service" FontWeight="SemiBold" />
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <Ellipse Width="10" Height="10" Fill="{Binding ServiceStatusColor}" Margin="0,0,8,0" VerticalAlignment="Center" />
                            <TextBlock Text="{Binding ServiceStatus}" />
                        </StackPanel>
                    </StackPanel>
                </ui:CardControl>
                <ui:CardControl Margin="4">
                    <StackPanel>
                        <TextBlock Text="Messages Today" FontWeight="SemiBold" />
                        <TextBlock Text="{Binding MessagesToday}" FontSize="24" FontWeight="Bold" Margin="0,4,0,0" />
                    </StackPanel>
                </ui:CardControl>
                <ui:CardControl Margin="4">
                    <StackPanel>
                        <TextBlock Text="Active Agents" FontWeight="SemiBold" />
                        <TextBlock Text="{Binding ActiveAgents}" FontSize="24" FontWeight="Bold" Margin="0,4,0,0" />
                    </StackPanel>
                </ui:CardControl>
                <ui:CardControl Margin="4">
                    <StackPanel>
                        <TextBlock Text="Pending" FontWeight="SemiBold" />
                        <TextBlock Text="{Binding PendingCount}" FontSize="24" FontWeight="Bold" Margin="0,4,0,0" />
                    </StackPanel>
                </ui:CardControl>
            </UniformGrid>

            <!-- Channel Status -->
            <TextBlock Text="Channels" Style="{StaticResource SubtitleTextBlockStyle}" Margin="0,0,0,8" />
            <UniformGrid Columns="3" Margin="0,0,0,16">
                <ui:CardControl Margin="4">
                    <StackPanel Orientation="Horizontal">
                        <ui:SymbolIcon Symbol="Chat24" Margin="0,0,8,0" />
                        <TextBlock Text="Discord" FontWeight="SemiBold" VerticalAlignment="Center" />
                        <Ellipse Width="8" Height="8" Fill="{Binding DiscordStatusColor}" Margin="8,0,0,0" VerticalAlignment="Center" />
                    </StackPanel>
                </ui:CardControl>
                <ui:CardControl Margin="4">
                    <StackPanel Orientation="Horizontal">
                        <ui:SymbolIcon Symbol="Send24" Margin="0,0,8,0" />
                        <TextBlock Text="Telegram" FontWeight="SemiBold" VerticalAlignment="Center" />
                        <Ellipse Width="8" Height="8" Fill="{Binding TelegramStatusColor}" Margin="8,0,0,0" VerticalAlignment="Center" />
                    </StackPanel>
                </ui:CardControl>
                <ui:CardControl Margin="4">
                    <StackPanel Orientation="Horizontal">
                        <ui:SymbolIcon Symbol="Phone24" Margin="0,0,8,0" />
                        <TextBlock Text="WhatsApp" FontWeight="SemiBold" VerticalAlignment="Center" />
                        <Ellipse Width="8" Height="8" Fill="{Binding WhatsAppStatusColor}" Margin="8,0,0,0" VerticalAlignment="Center" />
                    </StackPanel>
                </ui:CardControl>
            </UniformGrid>

            <!-- Recent Messages -->
            <TextBlock Text="Recent Messages" Style="{StaticResource SubtitleTextBlockStyle}" Margin="0,0,0,8" />
            <ui:CardControl>
                <ListView ItemsSource="{Binding RecentMessages}" BorderThickness="0">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80" />
                                    <ColumnDefinition Width="80" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="60" />
                                    <ColumnDefinition Width="140" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="{Binding Channel}" Foreground="CornflowerBlue" />
                                <TextBlock Grid.Column="1" Text="{Binding Sender}" FontWeight="SemiBold" />
                                <TextBlock Grid.Column="2" Text="{Binding Content}" TextTrimming="CharacterEllipsis" Margin="8,0" />
                                <TextBlock Grid.Column="3" Text="{Binding AgentId}" Foreground="MediumSeaGreen" />
                                <TextBlock Grid.Column="4" Text="{Binding CreatedAt, StringFormat='{}{0:MM/dd HH:mm}'}" HorizontalAlignment="Right" Opacity="0.6" />
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </ui:CardControl>
        </StackPanel>
    </ScrollViewer>
</Page>
