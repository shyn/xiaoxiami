<Page x:Class="TinyClaw.App.Views.LogsPage"
               xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
               xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
               xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
               xmlns:local="clr-namespace:TinyClaw.App.Views"
               Title="Logs">
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Text="Logs" Style="{StaticResource TitleTextBlockStyle}" Margin="0,0,0,16" />

        <!-- Filter Toggles -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12">
            <CheckBox Content="INFO" IsChecked="{Binding ShowInfo}" Margin="0,0,16,0" Checked="OnFilterChanged" Unchecked="OnFilterChanged" />
            <CheckBox Content="WARN" IsChecked="{Binding ShowWarn}" Margin="0,0,16,0" Checked="OnFilterChanged" Unchecked="OnFilterChanged" />
            <CheckBox Content="ERROR" IsChecked="{Binding ShowError}" Margin="0,0,16,0" Checked="OnFilterChanged" Unchecked="OnFilterChanged" />
            <ui:Button Content="Refresh" Icon="{ui:SymbolIcon ArrowSync24}" Click="OnRefreshClick" />
        </StackPanel>

        <!-- Log List -->
        <ListBox x:Name="LogList" Grid.Row="2" ItemsSource="{Binding Logs}"
                 BorderThickness="1"
                 ScrollViewer.VerticalScrollBarVisibility="Auto">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock x:Name="LogText" FontFamily="Consolas" FontSize="12" TextWrapping="NoWrap">
                        <Run Text="{Binding Timestamp, StringFormat='{}{0:HH:mm:ss}', Mode=OneWay}" Foreground="Gray" />
                        <Run Text=" [" /><Run x:Name="LevelRun" Text="{Binding Level, Mode=OneWay}" /><Run Text="] " />
                        <Run Text="{Binding Message, Mode=OneWay}" />
                    </TextBlock>
                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding Level}" Value="ERROR">
                            <Setter TargetName="LogText" Property="Foreground" Value="Tomato" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Level}" Value="WARN">
                            <Setter TargetName="LogText" Property="Foreground" Value="Gold" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Level}" Value="INFO">
                            <Setter TargetName="LogText" Property="Foreground" Value="White" />
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</Page>
